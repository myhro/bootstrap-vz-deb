#!/usr/bin/make -f
#export DH_VERBOSE=1

export PYBUILD_NAME=bootstrap-vz

%:
	dh $@ --with python2,sphinxdoc --buildsystem=pybuild


override_dh_auto_build:
	dh_auto_build
	PYTHONPATH=. http_proxy='127.0.0.1:9' sphinx-build -N -b html docs/ build/html


override_dh_auto_clean:
	dh_auto_clean
	rm -rf build/
	rm -rf *.egg-info/
	# Remove files cached by Sphinx
	rm -f docs/_static/graph.json
	find docs/plugins/ docs/providers/ docs/testing/system_test_providers/ -type f | egrep -v '(gitignore|index)' | xargs rm -f


override_dh_compress:
	# Files from the HTML documentation should not be compressed, as they may
	# render in broken links
	dh_compress --exclude "bootstrap-vz-doc/html/"


override_dh_install:
	dh_install
	# Remove entry point scripts from the library package
	rm debian/python-bootstrap-vz/usr/bin/*


override_dh_installchangelogs:
	dh_installchangelogs CHANGELOG.rst
